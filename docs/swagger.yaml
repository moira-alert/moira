basePath: /api
definitions:
  api.ErrorForbiddenExample:
    properties:
      error:
        example: you cannot access this resource
        type: string
      status:
        example: Forbidden
        type: string
    type: object
  api.ErrorInternalServerExample:
    properties:
      error:
        example: server error during request handling
        type: string
      status:
        example: Internal Server Error
        type: string
    type: object
  api.ErrorInvalidRequestExample:
    properties:
      error:
        example: resource with the ID does not exist
        type: string
      status:
        example: Invalid request
        type: string
    type: object
  api.ErrorNotFoundExample:
    properties:
      error:
        example: resource with ID '66741a8c-c2ba-4357-a2c9-ee78e0e7' does not exist
        type: string
      status:
        example: Resource not found
        type: string
    type: object
  api.ErrorRenderExample:
    properties:
      error:
        example: rendering error
        type: string
      status:
        example: Error rendering response
        type: string
    type: object
  dto.Contact:
    properties:
      id:
        example: 1dd38765-c5be-418d-81fa-7a5f879c2315
        type: string
      team_id:
        type: string
      type:
        example: mail
        type: string
      user:
        example: ""
        type: string
      value:
        example: devops@example.com
        type: string
    type: object
  dto.ContactList:
    properties:
      list:
        items:
          $ref: '#/definitions/moira.ContactData'
        type: array
    type: object
  dto.EventsList:
    properties:
      list:
        items:
          $ref: '#/definitions/moira.NotificationEvent'
        type: array
      page:
        example: 0
        type: integer
      size:
        example: 100
        type: integer
      total:
        example: 10
        type: integer
    type: object
  dto.NotifierState:
    properties:
      message:
        example: Moira has been turned off for maintenance
        type: string
      state:
        example: ERROR
        type: string
    type: object
  handler.ConfigurationResponse:
    properties:
      contacts:
        items:
          $ref: '#/definitions/handler.Contact'
        type: array
      remoteAllowed:
        example: false
        type: boolean
    type: object
  handler.Contact:
    properties:
      label:
        example: Telegram
        type: string
      type:
        example: telegram
        type: string
    type: object
  moira.ContactData:
    properties:
      id:
        type: string
      team:
        type: string
      type:
        type: string
      user:
        type: string
      value:
        type: string
    type: object
  moira.EventInfo:
    properties:
      interval:
        example: 0
        type: integer
      maintenance:
        $ref: '#/definitions/moira.MaintenanceInfo'
    type: object
  moira.MaintenanceInfo:
    properties:
      remove_time:
        example: 0
        type: integer
      remove_user:
        type: string
      setup_time:
        example: 0
        type: integer
      setup_user:
        type: string
    type: object
  moira.NotificationEvent:
    properties:
      contactId:
        type: string
      event_message:
        $ref: '#/definitions/moira.EventInfo'
      metric:
        example: carbon.agents.*.metricsReceived
        type: string
      msg:
        type: string
      old_state:
        example: ERROR
        type: string
      state:
        example: OK
        type: string
      sub_id:
        type: string
      timestamp:
        example: 1590741878
        type: integer
      trigger_event:
        example: true
        type: boolean
      trigger_id:
        example: 5ff37996-8927-4cab-8987-970e80d8e0a8
        type: string
      value:
        example: 70
        type: number
      values:
        additionalProperties:
          type: number
        type: object
    type: object
info:
  contact:
    email: opensource@skbkontur.com
    name: Contact Moira Team
  description: This is an API description for [Moira Alert API](https://moira.readthedocs.io/en/latest/overview.html).
  license:
    name: MIT
  title: Moira Alert
  version: master
paths:
  /api/config:
    get:
      operationId: get-web-config
      produces:
      - application/json
      responses:
        "200":
          description: Configuration fetched successfully
          schema:
            $ref: '#/definitions/handler.ConfigurationResponse'
      summary: Get available configuration
      tags:
      - config
  /contact:
    get:
      operationId: get-all-contacts
      produces:
      - application/json
      responses:
        "200":
          description: Contacts fetched successfully
          schema:
            $ref: '#/definitions/dto.ContactList'
        "422":
          description: Render error
          schema:
            $ref: '#/definitions/api.ErrorRenderExample'
      summary: Gets all Moira contacts
      tags:
      - contact
    put:
      consumes:
      - application/json
      operationId: create-new-contact
      parameters:
      - description: Contact data
        in: body
        name: contact
        required: true
        schema:
          $ref: '#/definitions/dto.Contact'
      produces:
      - application/json
      responses:
        "200":
          description: Contact created successfully
          schema:
            $ref: '#/definitions/dto.Contact'
        "400":
          description: Bad request from client
          schema:
            $ref: '#/definitions/api.ErrorInvalidRequestExample'
        "422":
          description: Render error
          schema:
            $ref: '#/definitions/api.ErrorRenderExample'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorInternalServerExample'
      summary: Creates a new contact notification for the current user
      tags:
      - contact
  /contact/{contactId}:
    delete:
      consumes:
      - application/json
      operationId: remove-contact
      parameters:
      - description: ID of the contact to remove
        in: path
        name: contactId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Contact has been deleted
        "400":
          description: Bad request from client
          schema:
            $ref: '#/definitions/api.ErrorInvalidRequestExample'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/api.ErrorForbiddenExample'
        "404":
          description: Resource not found
          schema:
            $ref: '#/definitions/api.ErrorNotFoundExample'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorInternalServerExample'
      summary: Deletes notification contact for the current user and remove the contact
        ID from all subscriptions
      tags:
      - contact
    put:
      consumes:
      - application/json
      operationId: update-contact
      parameters:
      - description: ID of the contact to update
        in: path
        name: contactId
        required: true
        type: string
      - description: Updated contact data
        in: body
        name: contact
        required: true
        schema:
          $ref: '#/definitions/dto.Contact'
      produces:
      - application/json
      responses:
        "200":
          description: Updated contact
          schema:
            $ref: '#/definitions/dto.Contact'
        "400":
          description: Bad request from client
          schema:
            $ref: '#/definitions/api.ErrorInvalidRequestExample'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/api.ErrorForbiddenExample'
        "404":
          description: Resource not found
          schema:
            $ref: '#/definitions/api.ErrorNotFoundExample'
        "422":
          description: Render error
          schema:
            $ref: '#/definitions/api.ErrorRenderExample'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorInternalServerExample'
      summary: Updates an existing notification contact to the values passed in the
        request body
      tags:
      - contact
  /contact/{contactId}/test:
    post:
      consumes:
      - application/json
      operationId: send-test-notification
      parameters:
      - description: The ID of the target contact
        in: path
        name: contactId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Test successfull
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/api.ErrorForbiddenExample'
        "404":
          description: Resource not found
          schema:
            $ref: '#/definitions/api.ErrorNotFoundExample'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorInternalServerExample'
      summary: Push a test notification to verify that the contact is properly set
        up
      tags:
      - contact
  /event/{triggerId}:
    get:
      operationId: get-events-list
      parameters:
      - description: The ID of updated trigger
        in: path
        name: triggerId
        required: true
        type: string
      - description: NNumber of items to be displayed on one page
        in: query
        name: size
        type: integer
      - description: Defines the number of the displayed page. E.g, p=2 would display
          the 2nd page
        in: query
        name: p
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Events fetched successfully
          schema:
            $ref: '#/definitions/dto.EventsList'
        "400":
          description: Bad request from client
          schema:
            $ref: '#/definitions/api.ErrorInvalidRequestExample'
        "404":
          description: Resource not found
          schema:
            $ref: '#/definitions/api.ErrorNotFoundExample'
        "422":
          description: Render error
          schema:
            $ref: '#/definitions/api.ErrorRenderExample'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorInternalServerExample'
      summary: Gets all trigger events for current page and their count
      tags:
      - event
  /event/all:
    delete:
      operationId: delete-all-events
      responses:
        "200":
          description: Events removed successfully
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorInternalServerExample'
      summary: Deletes all notification events
      tags:
      - event
  /health/notifier:
    get:
      operationId: get-notifier-state
      produces:
      - application/json
      responses:
        "200":
          description: Notifier state retrieved
          schema:
            $ref: '#/definitions/dto.NotifierState'
        "422":
          description: Render error
          schema:
            $ref: '#/definitions/api.ErrorRenderExample'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorInternalServerExample'
      summary: Get notifier state
      tags:
      - health
    put:
      consumes:
      - application/json
      operationId: set-notifier-state
      parameters:
      - description: New notifier state
        in: body
        name: state
        required: true
        schema:
          $ref: '#/definitions/dto.NotifierState'
      produces:
      - application/json
      responses:
        "200":
          description: Update state of the Moira service
          schema:
            $ref: '#/definitions/dto.NotifierState'
        "400":
          description: Bad request from client
          schema:
            $ref: '#/definitions/api.ErrorInvalidRequestExample'
        "422":
          description: Render error
          schema:
            $ref: '#/definitions/api.ErrorRenderExample'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/api.ErrorInternalServerExample'
      summary: Update notifier state
      tags:
      - health
swagger: "2.0"
tags:
- description: APIs for working with Moira contacts. For more details, see <https://moira.readthedocs.io/en/latest/installation/webhooks_scripts.html#contact/>
  name: contact
- description: View Moira's runtime configuration. For more details, see <https://moira.readthedocs.io/en/latest/installation/configuration.html>
  name: config
- description: APIs for interacting with notification events. See <https://moira.readthedocs.io/en/latest/user_guide/trigger_page.html#event-history/>
    for details
  name: event
- description: interact with Moira states/health status. See <https://moira.readthedocs.io/en/latest/user_guide/selfstate.html#self-state-monitor/>
    for details
  name: health
- description: manage notifications that are currently in queue. See <https://moira.readthedocs.io/en/latest/user_guide/hidden_pages.html#notifications/>
  name: notifications
- description: APIs for interacting with graphite patterns in Moira. See <https://moira.readthedocs.io/en/latest/development/architecture.html#pattern/>
  name: pattern
- description: APIs for managing a user's subscription(s). See <https://moira.readthedocs.io/en/latest/development/architecture.html#subscription/>
    to learn about Moira subscriptions
  name: subscription
- description: APIs for managing tags (a grouping of tags and subscriptions). See
    <https://moira.readthedocs.io/en/latest/user_guide/subscriptions.html#tags/>
  name: tag
- description: APIs for interacting with Moira triggers. See <https://moira.readthedocs.io/en/latest/development/architecture.html#trigger/>
    to learn about Triggers
  name: trigger
- description: APIs for interacting with Moira teams
  name: team
- description: APIs for interacting with Moira subscriptions owned by certain team
  name: teamSubscription
- description: APIs for interacting with Moira contacts owned by certain team.
  name: teamContact
